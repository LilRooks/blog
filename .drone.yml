kind: pipeline
name: default
when:
  event: [ push ]
  branch: [ main ]


steps:
- name: build
  image: cbrgm/drone-hugo
  settings:
    hugo_version: 0.55
    validate: true
    output: public
    url: https://blog.rooks.dev
- name: deploy
  image: appleboy/drone-scp
  settings:
    username: seven
    host:
      - rooks.dev
    port:
      from_secret: ssh_port
    key:
      from_secret: ssh_key
    source: public/*
    target:
      from_secret: target_blog
